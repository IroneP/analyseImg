/*
 * Image processing : edge detection
 *
 * Authors : Pascal Guehl, Clement Picq
 */
 
/**
 * @version 1.0
 */

#include "Image.h"

/******************************************************************************
 ******************************* INCLUDE SECTION ******************************
 ******************************************************************************/

// System
#include <cassert>

// STL
#include <algorithm>
#include <fstream>
#include <iostream>

/******************************************************************************
 ****************************** NAMESPACE SECTION *****************************
 ******************************************************************************/

// STL
using namespace std;

/******************************************************************************
 ************************* DEFINE AND CONSTANT SECTION ************************
 ******************************************************************************/
 
/******************************************************************************
 ***************************** TYPE DEFINITION ********************************
 ******************************************************************************/

/******************************************************************************
 ***************************** METHOD DEFINITION ******************************
 ******************************************************************************/

/******************************************************************************
 * Constructor
 ******************************************************************************/
Image::Image()
:   _width( 0 )
,   _height( 0 )
,   _name()
,   _data()
{
}

/******************************************************************************
 * Desstructor
 ******************************************************************************/
Image::~Image()
{
    // TODO
    // check openCV reference counter
    assert( false );
}

/******************************************************************************
 * Print info
 ******************************************************************************/
void Image::print()
{
    // LOG
    cout << "IMAGE info" << endl;
    cout << "- name: " << _name << endl;
    cout << "- size: [ " << _width << " x " << _height << " ]" << endl;
    cout << "- data: " << _data << endl;
}

/******************************************************************************
 * Load kernel from file
 *
 * @param pFilename
 *
 * @return flag telling whether or not it succeds
 ******************************************************************************/
bool Image::load( const char* pFilename )
{
    // LOG
    cout << "IMAGE" << endl;
    cout << "- file: " << pFilename << endl;

    // Try to open file
    ifstream file( pFilename, ios::in );
    if ( ! file.is_open() )
    {
        // Close file
        file.close();

        // LOG
        cout << "- ERROR : unable to open file." << endl;

        assert( false );

        // Return exit code
        return false;
    }

    // TODO
    // - read data
    // ...

    // Close file
    file.close();

    // Return exit code
    return true;
}

/******************************************************************************
 * @brief getKernel
 * @return
 ******************************************************************************/
const cv::Mat& Image::getData() const
{
    return _data;
}

/******************************************************************************
 * @brief editKernel
 * @return
 ******************************************************************************/
cv::Mat& Image::editData()
{
    return _data;
}
